# ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ—ï¸ ê°œìš”

ë§¤ì¼ê²½ì œ ì‹ ë¬¸ê¸°ì‚¬ ë²¡í„°ì„ë² ë”© í”Œë«í¼ì„ GCP ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ë¡œ êµ¬ì¶•í•˜ì—¬ ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. ë§¥ë¶ì—ì„œ ê°œë°œí•˜ê³  GCPì—ì„œ ì™„ì „ ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ë¡œ ìš´ì˜í•©ë‹ˆë‹¤.

## ğŸ¯ ì•„í‚¤í…ì²˜ ëª©í‘œ

### 1. **ì„œë²„ë¦¬ìŠ¤ ìš´ì˜**
- Cloud Run ê¸°ë°˜ ìë™ ìŠ¤ì¼€ì¼ë§
- ì„œë²„ ê´€ë¦¬ ë¶ˆí•„ìš”
- ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ

### 2. **ë§¤ë‹ˆì§€ë“œ ë°ì´í„°ë² ì´ìŠ¤**
- Cloud SQL PostgreSQL
- ìë™ ë°±ì—… ë° ê³ ê°€ìš©ì„±
- Private IP ì—°ê²°

### 3. **AI/ML ì„œë¹„ìŠ¤ í†µí•©**
- Vertex AI Vector Search
- Gemini API ì—°ë™
- ë§¤ë‹ˆì§€ë“œ ì„ë² ë”© ì„œë¹„ìŠ¤

### 4. **ë³´ì•ˆ ê°•í™”**
- VPC ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬
- Private ì„œë¹„ìŠ¤ ê°„ í†µì‹ 
- IAM ê¸°ë°˜ ì ‘ê·¼ ì œì–´

## ğŸ›ï¸ ì•„í‚¤í…ì²˜ êµ¬ì„±

### 1. **Cloud Run (ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI API   â”‚    â”‚ Streamlit Admin â”‚
â”‚   (Port 8000)   â”‚    â”‚   (Port 8501)   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ REST API      â”‚    â”‚ â€¢ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œâ”‚
â”‚ â€¢ ë²¡í„° ê²€ìƒ‰      â”‚    â”‚ â€¢ ëª¨ë‹ˆí„°ë§      â”‚
â”‚ â€¢ XML ì²˜ë¦¬      â”‚    â”‚ â€¢ ì„¤ì • ê´€ë¦¬      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•:**
- ìë™ ìŠ¤ì¼€ì¼ë§ (0-1000 ì¸ìŠ¤í„´ìŠ¤)
- ì„œë²„ë¦¬ìŠ¤ ìš´ì˜
- HTTPS ìë™ ì œê³µ
- ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ë°°í¬

### 2. **Cloud SQL (ë°ì´í„°ë² ì´ìŠ¤)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Cloud SQL PostgreSQL     â”‚
â”‚                                 â”‚
â”‚ â€¢ Private IP ì—°ê²°               â”‚
â”‚ â€¢ ìë™ ë°±ì—… (30ì¼ ë³´ê´€)          â”‚
â”‚ â€¢ SSL ì•”í˜¸í™”                    â”‚
â”‚ â€¢ ê³ ê°€ìš©ì„±                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•:**
- Private IP (10.0.1.0/24)
- ìë™ ë°±ì—… ë° ë³µêµ¬
- SSL/TLS ì•”í˜¸í™”
- ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

### 3. **Vertex AI (AI/ML ì„œë¹„ìŠ¤)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Vertex AI Platform       â”‚
â”‚                                 â”‚
â”‚ â€¢ Vector Search                 â”‚
â”‚ â€¢ Embedding API                  â”‚
â”‚ â€¢ Gemini API                    â”‚
â”‚ â€¢ ë§¤ë‹ˆì§€ë“œ ì¸ë±ìŠ¤               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•:**
- ë§¤ë‹ˆì§€ë“œ ë²¡í„° ê²€ìƒ‰
- ìë™ ì¸ë±ìŠ¤ ê´€ë¦¬
- ê³ ì„±ëŠ¥ ê²€ìƒ‰ ì—”ì§„
- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

### 4. **Cloud Storage (ë°ì´í„° ì €ì¥)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Cloud Storage             â”‚
â”‚                                 â”‚
â”‚ â€¢ XML íŒŒì¼ ì €ì¥                 â”‚
â”‚ â€¢ ì„ë² ë”© ë²¡í„° ìºì‹œ               â”‚
â”‚ â€¢ ë¡œê·¸ ë° ì•„í‹°íŒ©íŠ¸              â”‚
â”‚ â€¢ ë²„ì „ ê´€ë¦¬                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•:**
- ê¸€ë¡œë²Œ ë¶„ì‚° ì €ì¥
- ìë™ ë²„ì „ ê´€ë¦¬
- ìƒëª…ì£¼ê¸° ì •ì±…
- ì ‘ê·¼ ì œì–´

### 5. **VPC ë„¤íŠ¸ì›Œí¬ (ë³´ì•ˆ)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           VPC Network            â”‚
â”‚                                 â”‚
â”‚ â€¢ Private ì„œë¹„ìŠ¤ í†µì‹            â”‚
â”‚ â€¢ ë°©í™”ë²½ ê·œì¹™                    â”‚
â”‚ â€¢ NAT Gateway                   â”‚
â”‚ â€¢ VPC Connector                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•:**
- Private IP í†µì‹ 
- ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬
- ë³´ì•ˆ ê°•í™”
- íŠ¸ë˜í”½ ì œì–´

## ğŸš€ ë°°í¬ í”„ë¡œì„¸ìŠ¤

### 1. **ì¸í”„ë¼ ë°°í¬**
```bash
# Terraformìœ¼ë¡œ GCP ë¦¬ì†ŒìŠ¤ ìƒì„±
cd terraform
terraform init
terraform plan
terraform apply
```

**ìƒì„±ë˜ëŠ” ë¦¬ì†ŒìŠ¤:**
- VPC ë„¤íŠ¸ì›Œí¬ ë° ì„œë¸Œë„·
- Cloud SQL ì¸ìŠ¤í„´ìŠ¤ (Private IP)
- Cloud Storage ë²„í‚·
- Vertex AI Vector Search
- VPC Access Connector
- Artifact Registry

### 2. **ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë¹Œë“œ**
```bash
# FastAPI ì´ë¯¸ì§€
docker build -f Dockerfile.api -t mk-news-api:latest .
docker tag mk-news-api:latest asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-api:latest
docker push asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-api:latest

# Streamlit ì´ë¯¸ì§€
docker build -f Dockerfile.admin -t mk-news-admin:latest .
docker tag mk-news-admin:latest asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-admin:latest
docker push asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-admin:latest
```

### 3. **Cloud Run ì„œë¹„ìŠ¤ ë°°í¬**
```bash
# FastAPI ì„œë¹„ìŠ¤
gcloud run deploy mk-news-api \
    --image=asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-api:latest \
    --region=asia-northeast3 \
    --platform=managed \
    --allow-unauthenticated

# Streamlit ì„œë¹„ìŠ¤
gcloud run deploy mk-news-admin \
    --image=asia-northeast3-docker.pkg.dev/godwind2015/mk-news-repo/mk-news-admin:latest \
    --region=asia-northeast3 \
    --platform=managed \
    --allow-unauthenticated
```

## ğŸ“Š ì„œë¹„ìŠ¤ êµ¬ì„±

### 1. **FastAPI ì„œë¹„ìŠ¤ (mk-news-api)**
- **CPU**: 2 vCPU
- **ë©”ëª¨ë¦¬**: 4GB
- **í¬íŠ¸**: 8000
- **í™˜ê²½ë³€ìˆ˜**:
  - `GCP_PROJECT_ID`: godwind2015
  - `DB_HOST`: Cloud SQL Private IP
  - `DB_NAME`: mk_news
  - `STORAGE_BUCKET`: mk-news-storage-godwind2015
  - `VECTOR_INDEX_ID`: Vector Search ì¸ë±ìŠ¤ ID
  - `VECTOR_ENDPOINT_ID`: Vector Search ì—”ë“œí¬ì¸íŠ¸ ID

### 2. **Streamlit ì„œë¹„ìŠ¤ (mk-news-admin)**
- **CPU**: 1 vCPU
- **ë©”ëª¨ë¦¬**: 2GB
- **í¬íŠ¸**: 8501
- **í™˜ê²½ë³€ìˆ˜**:
  - `GCP_PROJECT_ID`: godwind2015
  - `API_URL`: FastAPI ì„œë¹„ìŠ¤ URL

### 3. **Cloud SQL ì¸ìŠ¤í„´ìŠ¤ (mk-news-db)**
- **ì—”ì§„**: PostgreSQL 15
- **ì¸ìŠ¤í„´ìŠ¤ í´ë˜ìŠ¤**: db-standard-2
- **ìŠ¤í† ë¦¬ì§€**: SSD
- **ë°±ì—…**: 30ì¼ ë³´ê´€
- **ë„¤íŠ¸ì›Œí¬**: Private IP (VPC ë‚´ë¶€)

### 4. **Vertex AI Vector Search**
- **ì¸ë±ìŠ¤**: mk-news-vector-index
- **ì°¨ì›**: 768
- **ê±°ë¦¬ ì¸¡ì •**: DOT_PRODUCT_DISTANCE
- **ì•Œê³ ë¦¬ì¦˜**: Tree-AH
- **ì—…ë°ì´íŠ¸ ë°©ì‹**: BATCH_UPDATE

## ğŸ”§ ìš´ì˜ ê´€ë¦¬

### 1. **ìë™ ìŠ¤ì¼€ì¼ë§**
- **ìµœì†Œ ì¸ìŠ¤í„´ìŠ¤**: 0 (ì„œë²„ë¦¬ìŠ¤)
- **ìµœëŒ€ ì¸ìŠ¤í„´ìŠ¤**: 1000
- **ìŠ¤ì¼€ì¼ë§ íŠ¸ë¦¬ê±°**: CPU ì‚¬ìš©ë¥ , ìš”ì²­ ìˆ˜
- **ì½œë“œ ìŠ¤íƒ€íŠ¸**: ~2-3ì´ˆ

### 2. **ëª¨ë‹ˆí„°ë§**
- **Cloud Logging**: ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
- **Cloud Monitoring**: ì„±ëŠ¥ ë©”íŠ¸ë¦­
- **Cloud Trace**: ë¶„ì‚° ì¶”ì 
- **ì•Œë¦¼**: ì˜¤ë¥˜ ë° ì„±ëŠ¥ ì„ê³„ê°’

### 3. **ë³´ì•ˆ**
- **IAM**: ì„œë¹„ìŠ¤ ê³„ì • ê¸°ë°˜ ê¶Œí•œ
- **VPC**: Private ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬
- **SSL/TLS**: ëª¨ë“  í†µì‹  ì•”í˜¸í™”
- **ë°©í™”ë²½**: ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ ë³´ì•ˆ

## ğŸ’° ë¹„ìš© ìµœì í™”

### 1. **ì„œë²„ë¦¬ìŠ¤ ë¹„ìš©**
- **Cloud Run**: ìš”ì²­ ìˆ˜ ë° ì‹¤í–‰ ì‹œê°„ ê¸°ë°˜
- **Cloud SQL**: ì¸ìŠ¤í„´ìŠ¤ í¬ê¸° ê¸°ë°˜
- **Vertex AI**: API í˜¸ì¶œ ìˆ˜ ê¸°ë°˜
- **Cloud Storage**: ì €ì¥ ìš©ëŸ‰ ê¸°ë°˜

### 2. **ë¹„ìš© ì ˆì•½ ì „ëµ**
- **ìë™ ìŠ¤ì¼€ì¼ë§**: ì‚¬ìš©ëŸ‰ì— ë”°ë¥¸ ìë™ ì¡°ì •
- **ë¦¬ì „ ì„ íƒ**: asia-northeast3 (ì„œìš¸)
- **ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤**: Standard â†’ Nearline â†’ Coldline
- **ë°±ì—… ì •ì±…**: 30ì¼ â†’ 7ì¼ë¡œ ì¡°ì • ê°€ëŠ¥

## ğŸš€ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸

### 1. **ì „ì²´ ë°°í¬**
```bash
./deploy_managed.sh
```

### 2. **ì„œë¹„ìŠ¤ ì¤‘ì§€**
```bash
./stop_managed.sh
```

### 3. **ì„œë¹„ìŠ¤ ì¬ì‹œì‘**
```bash
./restart_managed.sh
```

## ğŸ“ˆ ì„±ëŠ¥ íŠ¹ì„±

### 1. **ì‘ë‹µ ì‹œê°„**
- **API ì‘ë‹µ**: í‰ê·  200-500ms
- **ë²¡í„° ê²€ìƒ‰**: í‰ê·  100-300ms
- **ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬**: í‰ê·  50-150ms
- **ì½œë“œ ìŠ¤íƒ€íŠ¸**: 2-3ì´ˆ

### 2. **ì²˜ë¦¬ëŸ‰**
- **ë™ì‹œ ìš”ì²­**: 1000+ RPS
- **ë²¡í„° ê²€ìƒ‰**: 100+ QPS
- **XML ì²˜ë¦¬**: 100+ íŒŒì¼/ë¶„
- **ì„ë² ë”© ìƒì„±**: 50+ ë¬¸ì„œ/ë¶„

### 3. **ê°€ìš©ì„±**
- **SLA**: 99.9%
- **ë‹¤ì¤‘ ë¦¬ì „**: ìë™ ì¥ì•  ì¡°ì¹˜
- **ë°±ì—…**: ìë™ ë³µêµ¬
- **ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ì•Œë¦¼

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. **ì¼ë°˜ì ì¸ ë¬¸ì œ**
- **ì½œë“œ ìŠ¤íƒ€íŠ¸ ì§€ì—°**: ì²« ìš”ì²­ ì‹œ 2-3ì´ˆ ì§€ì—°
- **ë©”ëª¨ë¦¬ ë¶€ì¡±**: ë°°ì¹˜ í¬ê¸° ì¡°ì • í•„ìš”
- **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°**: Private IP ì„¤ì • í™•ì¸
- **ê¶Œí•œ ì˜¤ë¥˜**: ì„œë¹„ìŠ¤ ê³„ì • ê¶Œí•œ í™•ì¸

### 2. **ëª¨ë‹ˆí„°ë§ ëª…ë ¹ì–´**
```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
gcloud run services list --region=asia-northeast3

# ë¡œê·¸ í™•ì¸
gcloud run logs tail mk-news-api --region=asia-northeast3

# ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ
gcloud sql instances describe mk-news-db

# Vertex AI ìƒíƒœ
gcloud ai index-endpoints list --region=asia-northeast3
```

## ğŸ“š ì°¸ê³  ìë£Œ

- [Cloud Run ë¬¸ì„œ](https://cloud.google.com/run/docs)
- [Cloud SQL ë¬¸ì„œ](https://cloud.google.com/sql/docs)
- [Vertex AI ë¬¸ì„œ](https://cloud.google.com/vertex-ai/docs)
- [VPC ë¬¸ì„œ](https://cloud.google.com/vpc/docs)

---

**ë§¤ì¼ê²½ì œ ì‹ ë¬¸ê¸°ì‚¬ ë²¡í„°ì„ë² ë”© í”Œë«í¼**  
GCP ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜  
MK AI Project - godwind2015@gmail.com

